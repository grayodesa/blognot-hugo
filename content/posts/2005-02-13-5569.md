---
title: Так вот, по поводу перезда
author: Gray
type: posts
date: 2005-02-12T22:56:45+00:00
excerpt:
url: /5569
dsq_thread_id:
  - 5553676
esml_socialcount_LAST_UPDATED:
  - 1497187322
essb_cache_expire:
  - 1576733814
categories:
  - Uncategorized

---







Так вот, по поводу перезда Movable Type. До начала этой операции мне казалась абсолютно логичной мысль, что проблем быть не должно &#8212; это ж не Windows, где существует еще таинственный реестр, и не бинарные исполняемые файлы, которые в Юниксе надо компилировать на конкретной машине. Есть файлы скрипта, есть файлы данных, перенести, мол, их на новое место, прописать заново пути и готово.  
Что интересно &#8212; для форума и баннерной крутилки это сработало на ура &#8212; перетащили себе скрипты, сделали дампы mySQL баз на старом сервере, влили их на новом и все заработало. На переключение форума у меня ушло минут 25 &#8212; из которых минут 10 дамп сжимался на старом сервере, а потом еще минут 5 разжимался на новом, плюс минуты 3-4 он качался с сервера на сервер. А вот для MovableType этот вариант не прошел.  
Для начала скопированные файлы отказались работать. Т.е. скрипт отвечал отказом на попытку залогиниться в систему и вообще сообщал, что не знает такого пользователя. Руководствуясь священным принципом &#171;Я не первым наступаю на грабли&#187;, я отправился читать форум поддержки и мануал. Действительно, проблема известна и вызывает ее различие версий Berkeley DB на серверах. Мне не понять, почему разработчики этой базы не могут обеспечить совместимость форматов &#8212; при том, что у mySQL 5-й версии не возникает никаких проблем прочесть базу, созданную 3-й версией, &#8212; ну да ладно. Поскольку проблема была известна, было и решение &#8212; проапгрейдить базу утилитой db_upgrade. И тут начались первые грабли.  
Эта утилита работать отказалась. Второй способ заключался в ручной выгрузке данных из файлов базы и загрузке их обратно. Неа, не вышло.  
Третий способ заключался в переходе на mySQL. Для этого надо было на старом сервере сконвертировать базу и перенос становился простым и легким. Ага, щаз, как говорит Задорнов. Данный блог &#8212; а он стоит на отдельной инсталляции, &#8212; конвертироваться в mySQL отказался наотрез. Ошибка при загрузке данных и все тут. Кстати, неизвестно, что лучше &#8212; вторая инсталляция сконвертировала базу и вылез очередной глюк &#8212; Movable Type на новом сервере не может понять кодировку базы. Сейчас воюем с этим.  
В итоге пришлось пойти тупым лобовым путём &#8212; экспортировать все записи из блога на старом сервере, вручную перенести все шаблоны и импортировать записи на новом сервере. Кстати, попутно прибил дубликаты записей, возникшие при переходе на новую версию.  
В общем, главный вывод, который лучше сделать как можно раньше при работе с Movable Type &#8212; отказывайтесь от использования Berkeley DB. Никакого особого преимущества это не дает &#8212; если вы генерите статические страницы в блоге, то процессор с любой базой грузится лишь при новых постах, а проблемы, как видно, создать может вполне ощутимые из-за своих особенностей. В отличие от нее, mySQL база легче переносится, ею легче управлять &#8212; phpmyadmin очень многое позволяет сделать, &#8212; да и в любом случае она на сервере уже есть практически всегда.  
Так что рекомендую.